!*********************************COPYRIGHT******************************************
!																				    !
!       THE NONMEM SYSTEM MAY BE DISTRIBUTED ONLY BY ICON DEVELOPMENT               !
!       SOLUTIONS.                                                                  !
!                                                                                   !
!       COPYRIGHT BY ICON DEVELOPMENT SOLUTIONS                                     !
!       2009-2013 ALL RIGHTS RESERVED.                                              !
!                                                                                   !
!       DO NOT ATTEMPT TO MODIFY CODE WITHOUT FIRST CONSULTING WITH                 !
!       ICON DEVELOPMENT SOLUTIONS.                                                 !
!                                                                                   !
!************************************************************************************
!
!-----------------------------HISTORY------------------------------------------------
! VERSION     : NONMEM VII
! AUTHOR      : ROBERT J. BAUER
! CREATED ON  : ....
! LANGUAGE    : FORTRAN 90/95
! LAST UPDATE : FEB/2009 - BAYESIAN METHOD INCLUDED
!               JUN/2009 - INTEGRATED BETA 5.5B4 MODIFICATIONS
!               AUG/2013 - INTEGRATED NONMEM7.3a7.1 CHANGES
!
!----------------------------- TOTAL.INC -------------------------------------
!
! DESCRIPTION : 
!
! ARGUMENTS   : NONE
!
! CALLED BY   : TOTAL.INC is included in the following subroutines
!				IOUNIT_SETUP,BAYES_DEFAULTS,BAYES_DEFAULTSE,LOAD_ESTIMS,BESTM_LOAD,
!               NEXT_ESTIMATE,BAYES_FCON_READ,BAYES_FCON_READ_CHAIN,ESTM_VIS_ARRAY,
!               FORMAT_SETUP,FORMAT_WRITE,FORMAT_WRITE2,FORMAT_SWRITE,BAYES_ESTIMATE,
!               BAYES,PROBLEM_DEALLOCATE,INTR2,ZXMCMC,CHAIN_SAMPLE_MAKE_CHAIN,TRACE,
!               BAYES_OBJSTD,BAYES_SETUP1,PROBLEM_ALLOCATE,REALLY_QUIT,BAYES_OBJ,
!               BAYES_BANNER_WRITE,BAYES_PRDNCOV_MAKE,BAYES_PRDNCOV_MAKEH,PRINT_EIGEN,
!               BAYES_LOAD_FROM_NONMEM,BAYES_COVMAPW,BAYES_OBJ2_1,BAYES_OBJ2_2,IET,
!               BAYES_OBJ2_3,BAYES_OBJ2,IPH,BAYES_DECN,BAYES_OMEG_UPDATE,POPVAR_INIT,
!               POPVAR_PUT,ORDER_RANGES,INTR2_HEADER,POPVAR_SUM,POPVAR_FINAL,BAYES_INIT,
!               POPVAR_TO_MEAN,WINBUG_OMEG_SAMPLE_MAKE,BAYES_COVMAP2,DEGF_CALC,
!               WISHART_RANDOM,MCMC_ETA_SAMPLING_SETUP,OBJP_FROM_OBJ,PMX_SETUP,POPVAR_GET,
!               MCMC_ETA_SAMPLING_SETUP3,WINBUG_OMEG_DENSITY,OBJ_FROM_OBJP,BAYES_PRIOR1,
!               BAYES_PRIOR2,HPRIOR_GET,BAYES_HPRIOR_ONLY,PRINT_ARRAY,SUMSQ_STOP2,
!               POPFINISH_TEST,POPITER_SUMMATION,CHAIN_SAMPLE_MAKE,NEW_INITIAL_WRITE,
!               SUMSQ_ZERO2,SUMSQ_ZERO,SUMSQ_STORE,ESUMSQ_STORE2,ESUMSQ_ZERO2,ESUMSQ_ZERO,
!               ESUMSQ_STORE,ESUMSQ_STORE3,SUMSQ_STORE2,SUMSQ_WRITE,SUMSQ_CROSS_COUNT,
!               SUMSQ2_SAVE,SUMSQ2_RESTORE,BAYES_INITIALIZE,THMUPMU_UPDATE,CONSTRAINT,
!               UCPETA_GET,ESTIM_SETTINGS,ETABAR_FILE_WRITE,UCPETA_PUT,BAYES_COVMAPW2,
!               MCETA_GET,NFGH_CALC,DATNN_WORKER_SAVE,VPARAM_ADD3,DATNN_WORKER_READ,
!               PNM_WORKER_PROCESS,IPARW,PMXMIX,EMBAYES_WORKER_SAVE,EMBAYES_WORKER_READ,
!               PNM_INIT_RW,MUMODEL3,PX2AB_EVALUATE,SAEM,MCMC_ETA_SAMPLING,HPROCESS6,
!               VPARAM_CLEAR,VPARAM_CLEAR2,VPARAM_ADD,BANNER_WRITE2,VPARAM_ADD4,EM_UPDATE,
!               MPARAM_UPDATE,MPARAM_ADD,PMXTHT_DER,PTHETA_FINAL,TOLC,SEM_UPDATE,OBJ_SETUP,
!               SAEM_NEXT_CALC,SAEM_PROCESS,BAYES_OBJ2V,FDISPLAY,VPARAM_UPDATE,POMEG_FINAL,
!               GIBBS_PRDN_CREATE,EMC_UPDATE,HPGRAD_EVAL,POPFINAL,BAYES_SETUP2,VPARAM_ADD5,
!               IBAYES_CONDITION,IBAYES_ITS,PHI_ACCUM,BAYES_OBJI,BANNER_WRITE,NPD_PUT,
!               PMUD_EVALUATE,PMUD2_EVALUATE,PX2A_EVALUATE,PX2B_EVALUATE,WSP_TO_OUTPT,
!               DELTA_FIND,BAYES_MSFI_IGNORE,USER_TERMINATE_TEST,ETAI_TO_DAT4,DAT4_TO_ETAI,
!               FU_ETA,FL1E_GET,ETA_LOAD,MSFO_TO_DAT4,DAT4_TO_MSFO,BAYES_PRINT_ITER,
!               NSIG_PROCESS,POPSUM_COV2,ICOVRP_TEST,HPRIOR_OTERM1,HPRIOR_OTERM2,PRIOR_OFF,
!               POPSUM_EXTRA2,CONSTRAINT_MATRIX,OMEG_TO_CHLI,CHLI_TO_OMEG,POP_EXTRA_CLEAR2,
!               POP_EXTRA_CLEAR3,POP_EXTRA_CLEAR,POP_EXTRA_ADD2,POP_EXTRA_ADDP,SID_RESET,
!               POP_EXTRA_ADD3F,POP_EXTRA_ADD,POPSUM2_RESPONSE,SIGMA_CHOL_DIF,BANNER_SETUP,
!               ZXMIN1_WRITE,ZXMIN1_SEWRITE,OMVAR_SIGMA_TRANSPOSE,ETA_POPSAMPLE_SETUP,
!               ETA_POPSAMPLE,ETA_POPSAMPLE_FINISH,WRES_MAT_STORE,GET_LABEL,IXTBLE_REMAP,
!               WRES_SETUPS,WRES_SETUP,PRRESE,EXTRA_LABEL_INFO,POPPHI_PUT,POPPHIM_PUT,
!               POPCOV_PUT,POPCOV_PUT2,COVMAP,SIGLCOV_SETUP,SIGLCOV_DONE,PMX_SETUP_EXTRA,
!               NSIG_PROCESS2,BLOCK_INFO_SAVE,BLOCK_INFO_PROCESS,SAME_BLOCK_AVERAGE,
!               SAME_PRIOR_EXPAND,NPDE_SAMPLE_MAKE,IOMEG_SAME_PROCESS,PMX_SETUP_SUMMARY,
!               PMX_SETUP_WRITE,STEPMOD,PARTIAL_OUTPT,NPAT_FIND,NPDE_SAMPLE_FINALIZE,
!               XML_OUTPUT,XML_WRITE,XML_START_TAG,XML_END_TAG,XML_ITER_WRITE,XML_VAL_WRITE,
!               XML_IVAL_WRITE,XML_SVAL_WRITE,XML_WRITE_OFF,XML_WRITE_ON,XML_PROB_WRITE,
!               XML_PARALLEL,XML_CONV_WRITE,XML_VAL2_WRITE,FILE_TO_XML,XML_PREFIX_ADD,
!               ITER_WRITE,EVENT_REPEAT_SETUP,VARCORR,PRINT_CORR,PRINT_CORRSE,SIGMA_DER_EASY,
!               SIGMA_DER_EASY,SIGMA_UPDATE_EASY,SIGMA_DER2_EASY,GRADIENT_PUT,NOPRIOR_TEST,
!               POPFINISH_WRITE,NPDERW,NPE_PUT,IMP_STUFF_WRITE,SID_SET,SID_SET2,BAYESCHOLINV,
!               SIGL_DEFAULT,MCMC_ETA_SAMPLING_SETUP2,WINBUG_SAMPLE_MAKE,POP_EXTRA_ADD3,
!               BAYES_PRIOR3
!               
!
! CALLS       : NONE
!
! ALGORITHM   : 
!
! MODULES USED: SIZES,FSIZES,NMDATA,NMPRD_INT,CMNM1_INT,CMNM2_INT,CMNM3_INT,CMNM4_INT,
!               CMNM5_INT,CMNM6_INT,CMNM7_INT,ROCM_INT,NMBAYES_INT,NMPRD_REAL,CMNM1_REAL,
!               CMNM2_REAL,CMNM3_REAL,CMNM4_REAL,CMNM5_REAL,CMNM6_REAL,CMNM7_REAL,
!               ROCM_REAL,NMBAYES_REAL,ROCM_CHAR,NMBAYES_CHAR
!
! CONTAINS    : NONE
!
! LOCAL'S     : NONE
!
!---------------------------- END OF HEADER -----------------------------------------
!
      USE SIZES,     ONLY: DPSIZE,ISIZE,MAXVRESWRES,MAXVRESN,INT_SMALL                           
      USE FSIZES,    ONLY: F_MAXOMEG,F_MAXPTHETA,F_LPAR3,F_MAXNSP,F_LVR,F_LPAR,&
                           F_NSIGM,F_LVO,F_LVS,F_LOST,F_MAXSIGM
      USE NMDATA,    ONLY: IUN,TITL01,NSIGL=>NSIG
! INTEGER      
      USE NMPRD_INT, ONLY: NTHETA,NETA,NEPS,IVEST,IVESTB,NAETA,LVOUT,ISETNTH,  &
                           NOEPS,IFRSTDER,ISECDER,INDXS,IPROB,IQUIT,IDXMDV,NDI,&
                           NETAT,NEPST,SIGMAOFFSET,NTHETAT
      USE CMNM1_INT, ONLY: NIND,NMAXMIX,ITRANPAR,ISCALPAR,IND,IOMGR,IFRSTGR,   &
                           MAXFN,NSIG,IMSFO,IPRNTINT,IREPEAT1,IPOSTHOC,IINTER, &
                           IINTER2,ILAP,INONP,ICOND,INPETA,INPMSFO,ISLOWGR,    &
                           ICENTER,INUMER,IFOMOD,IPRDFLG,IHYBRID,ISTIELT,IMIX, &
                           IREPEAT2,IETABAR,SIGL,NPAR10,IPRIOR,VRES_OFFSET,    &
                           IXTBLE_OFFSET,WRES_DEFAULT,SIGLCOV,TOLCOV,VRESD,    &
                           VRESN,SIGLO,SIGLOCOV,ATOLCOV,NPNIND,NIND_ORIG,      &
                           IINTER_IMPOSE
      USE CMNM2_INT, ONLY: NAETAI,LVOUTI,NAETAN,LVOUTN,NTHT_P,NETA_P,NEPS_P,   &
                           NEXP_P,ICOMPRS,IRECIDX,NRECIND,ICOVR,IESTM,NESTETAH,&
                           IEOB21,IEOB22,NINDETA,NWINTL,NOBSIND,IEVAL
      USE CMNM3_INT, ONLY: AVAIL,INPRECOM,ICOVMAT,ICOVEIGN,ICOVPRNT
      USE CMNM4_INT, ONLY: IINV,IABRTEST,IER,NOHABORT
      USE CMNM5_INT, ONLY: NETAEST,NR,NS
      USE CMNM6_INT, ONLY: NTABLES2,NSCAT2,NFNCEVAL,NETASCL,IWREST,IESTEXCL,   & 
                           IESTEXCL,ICOVEXCL,NITEM,IXTBLE,IDXABS,IDXORD,       &
                           TABWRESCHOL
      USE CMNM7_INT, ONLY: NREPSLFT,ISORTOBJ,NEIGNVAL,ITBL
      USE ROCM_INT,  ONLY: MIXCALL,IEST_ERR,ICOV_ERR
      USE NMBAYES_INT
      USE EST_DEFS
! REAL                           
      USE NMPRD_REAL,ONLY: DB,LB,UB,INFNTY
      USE CMNM1_REAL,ONLY: VDATREC,UCPAR10
      USE CMNM2_REAL,ONLY: THETAO,VEST,ETAIND,VETA,VINVF,ETABAR,SUMETASQ,      &
                           SHRINKETA,SHRINKEPS,SUMEBV
      USE CMNM3_REAL,ONLY: THETA,VARNC,VINV,LGDET,LGDETB
      USE CMNM4_REAL,ONLY: OFVOLD
      USE CMNM5_REAL,ONLY: UCPETA,VINVETA,LGDETETA,R0,R11
      USE CMNM6_REAL,ONLY: SCLETA
      USE CMNM7_REAL,ONLY: LGDETP,COVM,SE_THTA,SE_OMSG,CORRM,EIGENVLS,COVINM,  &
                           SMATV,RMATV,WSP2T=>COVM,WSP4=>COVINM,WSP2=>SMATV
      USE ROCM_REAL, ONLY: HL1,POSTV,THETAC,VARNF,MIXP,OBJECT,THETAF,OMEGAF,   &
                           SIGMAF,SETH,SEOM,SESIG
      USE NMBAYES_REAL
! CHARACTER
      USE ROCM_CHAR, ONLY: LABEL
      USE NMBAYES_CHAR
!
      IMPLICIT NONE